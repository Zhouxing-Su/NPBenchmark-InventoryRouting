# Note

观察目标构成
  看哪一类目标惩罚最多(堆积成本和路由成本哪个比重更大?)
  有无明显不合理的地方(多次配送量很少的配送)

当前模型改进:
[] 一个节点只要在任意一个不固定的周期内被考虑则在所有不固定周期内都应被考虑?
连续改进时增加不固定路由的周期数
[x] 当前解中各周期未访问的节点有一定概率在对应周期忽略该点不加入模型


新框架:
先用库存问题的模型计算每个周期给哪些节点送多少 (多辆车时可能要留出部分余量避免最后匀不过来)
然后每个周期分别计算路由 (问题变为 TSP 或 VRP)
之后再综合考虑路由和配送量

[] 初始方案
  [] 将一个界比较紧的 TSP 模型加入库存问题模型估算路由开销
    [] 松弛布尔变量可以取实数 (完整模型)
    [] **不考虑子回路 (传统模型)**
  [] 简单估算路由开销
    [] 用直接往返于仓库与客户节点的距离作为路由开销估计
  [] 将最小生成树模型加入库存问题模型估算路由开销
      [] 松弛布尔变量可以取实数
      [] 度约束的最小生成树
  [] 简单启发信息
    [x] 经济配送量 (算例规律: 容量为每周期消耗的 2 到 3 倍, 初始库存为每周期消耗的 1 到 2 倍)
      [x] 每周期一旦有配送则配送量大于给定值
    [] 经济配送次数
      [] 每个客户被访问过周期的总数小于给定值
      [] 每辆车每个周期访问的客户数小于给定值
  [] **伪列生成**
    [] 预先生成大量单个周期的 TSP 最优解
      [] 从曾经找到过的次优解中学习和挖掘搜索过程中可能需要计算 TSP 的节点集合
      [] 通过松弛模型等技巧直接分析搜索过程中可能需要计算 TSP 的节点集合
    [] 直接通过组合最优环路求解
[] 方案调整
  [x] **在松弛解的基础上, 固定配送量精确计算各周期的路由得到完整解, 更新最优解后禁掉当前解继续搜索, 松弛解比历史最有解差时证明最优性**
    [x] ~~惰性约束~~ vs 更新模型
    [x] ~~禁止各周期走相同的路径~~ vs 禁止各周期访问的节点完全一致 (访问过的 + (1 - 没访问的) < N)
    [] 使用缓存避免重复计算单个周期的 TSP (访问的节点完全一致)
    [] 使用松弛解快速修复得到的解作为 TSP 初始解 vs 使用节点集相似度较高的解作为 TSP 初始解
  [] 直接调整路由, 然后计算当前路由下的最优配送量
    [] 加节点, 删节点, 周期间移动或交换节点等简单邻域动作
    [] **Ejection Chain**
  [] 修改配送量目标权重得到新的配送方案, 再各周期分别计算路由
    [] **使用强化学习得到路由开销的估算函数, 代入库存模型的目标得到近似完整模型求解**
    [] 增加路由开销较大的周期的惩罚系数
      [] 总运输成本
      [] 单位运输成本
    [] 增加各周期中较长边及相关节点的惩罚系数
      [] 绝对长度较长
      [] 远近程度排名靠后 (某节点最长出度/某节点最长入度)
    [] **提升总是出现在解/子回路中的节点/边的权重**
    [] **根据节点在最优路径中的出入度边长调整节点权重 (消除松弛子回路后模型无法准确估算下界的问题)**
  [] 路由确定的情况下用最小费用流计算堆积成本最小的配送量
[] 启发信息
  [] 计算一次 N 辆车的 VRP(-TW), 将客户划分为多个区域 (局部搜索调整路由时优先考虑将同区域的节点加入路径)
    [] 时间窗可以根据从初始库存或者满库存开始的断供时间设置
    [] 车辆数根据大多数客户的断供时间设置 (例如大多数客户会在 3 个周期内断供, 则可以认为每 3 个周期所有客户都要被访问一次)
